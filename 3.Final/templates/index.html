<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAFEHOOD</title>
    <!-- Inclure les fichiers CSS de Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Inclure le fichier CSS personnalisé -->
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}"> -->

    <link rel="stylesheet" href="/static/styles.css">

</head>
<body>
    <div class="container">
        <h1>SAFEHOOD</h1>
        
        <!-- ... Autres balises HTML ... -->

        <section id="image-section">
            <h2>Image avec liste d'ingrédients</h2>
            <div class="row">
                <div class="col-md-6">
                    <form action="/convert_to_text" method="POST" enctype="multipart/form-data" onsubmit="convertToText(event)">

                        <label for="image-upload">Télécharger une image :</label>
                        <input type="file" name="file" id="image-upload" accept="image/*">
                        <input type="submit" value="Convertir en texte">
                    </form>
                    <div id="result">
                        <!-- La sortie OCR sera affichée ici -->
                        Texte extrait de l'image : <span id="text-content"></span>
                    </div>
                </div>
                <div class="col-md-6">
                    <p>Posez votre image avec votre liste d'ingrédients ici.</p>
                    <img id="uploaded-image" src="" alt="Image téléchargée" style="max-width: 100%">
                </div>
            </div>
            <!-- Formulaire pour la conversion en noir et blanc -->

        </section>

        <!-- ... Autres balises HTML ... -->
    </div>
    
    <!-- Inclure les fichiers JavaScript de Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Fonction pour afficher l'image téléchargée
        document.getElementById('image-upload').addEventListener('change', function (event) {
            const uploadedImage = document.getElementById('uploaded-image');
            const file = event.target.files[0];
            
            if (file) {
                const reader = new FileReader();
                
                reader.onload = function (e) {
                    uploadedImage.src = e.target.result;
                };
                
                reader.readAsDataURL(file);
            } else {
                uploadedImage.src = '';
            }
        });


        // Fonction pour la conversion en texte (à adapter)
        function convertToText(event) {
            event.preventDefault(); // Empêche la soumission du formulaire par défaut

            // Récupération des données du formulaire
            const formData = new FormData(event.target);

            // une requête AJAX pour envoyer les données au serveur (à adapter)
            fetch("/convert_to_text", {
                method: "POST",
                body: formData
            })
            .then(response => response.text())
            .then(text => {
                // Affichage du résultat dans la div "text-content"
                document.getElementById("text-content").textContent = text;
                //document.getElementById("result").innerHTML = 'Texte extrait de l\'image : <span id="text-content">' + text + '</span>';

            })
            .catch(error => {
                console.error("Erreur lors de la conversion en texte : " + error);
            });
        }
    </script>
</body>
</html>
